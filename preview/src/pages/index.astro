---
import { Code } from "astro:components";
import * as fs from "node:fs/promises";

import hurlGrammar from "../../../grammar/hurl.tmlanguage.json" with {
  type: "json",
};

const lang = {
  ...hurlGrammar,
  // embeddedLangs: ["xml", "graphql", "json"]
};

const files = fs.glob("../test/**/*.hurl");

const samples = [];
for await (const file of files) {
  samples.push({
    name: file.substring("../test/".length),
    content: await fs.readFile(file, "utf-8"),
  });
}
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width" />
		<title>Hurl Syntax Preview</title>
	</head>
	<body>
		<h1>Hurl Syntax Preview</h1>
		<main>
		{
			samples.map((sample) => (
				<article>
					<h2>{sample.name}</h2>
					<Code class="code" code={sample.content} lang={lang}  theme="github-dark-default" />
				</article>
			))
		}
		</main>
	</body>
</html>
<style>
	html,
	body {
		margin: 0;
		padding: 0;
		background: #0b0f14;
		color: #e6eef6;
		font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
			"Helvetica Neue", Arial, sans-serif;
		line-height: 1.5;
	}

	h2 {
		margin-bottom: 0;
	}

	a {
		color: #4fb3ff;
		text-decoration: none;
	}

	a:hover,
	a:focus {
		text-decoration: underline;
	}

	button,
	input,
	textarea,
	select {
		background: #0f1419;
		color: #e6eef6;
		border: 1px solid #333;
		border-radius: 6px;
		padding: 0.5rem 0.75rem;
	}

	hr {
		border: none;
		border-top: 1px solid #333;
		margin: 1rem 0;
	}

	body {
		max-width: 600px;
		margin: 0 auto;
	}

	main {
		display: flex;
		flex-direction: column;
		gap: 10px;
	}

	.code {
		margin: 0;
		padding: 10px;
	}
</style>
